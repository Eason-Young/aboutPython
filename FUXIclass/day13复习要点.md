复习要点：第十三天	使用Nginx和uWSGI部署我们的项目

----

00-如何将我们的代码上传到服务器和配置项目运行环境

```
上传项目代码：
- 第一种方式：通过scp命令远程拷贝完整项目代码文件，scp命令的使用如下链接
  http://www.runoob.com/linux/linux-comm-scp.html

- 第二种方式：通过类似于git的代码托管服务器中转「公司使用的可能是收费版的git或自己搭建的svn」
  1.将完整项目代码上传到代码托管服务器
  2.在真正代码上线的服务器上安装代码托管服务的客户端，将完整项目代码下载下来

不排除有更多的方式
```

```
配置项目环境：
- 第一种方式：
	在本地：通过命令 pip freeze >> packages.txt 将我们开发时使用的模块名称和对应的版本号保存到文本中
	将文本上传到服务器
	在服务器：通过命令 pip install -r packages.txt 批量安装模块
	
- 第二种方式：
	直接将本地的虚拟环境打包发送到服务器使用
	https://blog.csdn.net/qq_34146899/article/details/52454616
	使用时需要注意，直接使用无效，我们需要从以下两种方法中选择一种修改虚拟环境中的文件：
		第一种：选择将虚拟环境文件夹下的bin目录下的activateX、pipX等启动文件和可执行文件中的关于虚拟文件夹的路径需要改为在服务器上的真实路径
		第二种：将虚拟环境文件夹在服务器中的存放路径更改到与本地存放路径一致「推荐使用这种方式，改动比较小」
	
- 第三种方式：
	使用docker容器技术，将整个镜像打包到服务器，然后在服务器上开启镜像，运行镜像中的项目代码。需要通过端口映射，将客户端对服务器的特定端口的访问转发到镜像中。

```

---

01-了解Nginx服务器

```
了解Nginx：
	Nginx (engine x) 是一个高性能的HTTP和反向代理服务，也是一个IMAP/POP3/SMTP服务。Nginx是由伊戈尔·赛索耶夫为俄罗斯访问量第二的Rambler.ru站点（俄文：Рамблер）开发的，第一个公开版本0.1.0发布于2004年10月4日。

优点：
    可以在大多数 Unix Linux OS 上编译运行，并有 Windows 移植版。
    采用C进行编写，系统资源开销小，CPU使用效率高
    安装非常的简单、配置文件非常简洁（还能够支持perl语法）、Bug非常少
    启动特别容易，并且几乎可以做到7*24不间断运行，即使运行数个月也不需要重新启动。你还能够不间断服务的情况下进行软件版本的升级。
    处理静态文件的性能优越
    可以很简单的实现负载均衡和反向代理
    
相关概念：
	正向代理、反向代理、负载均衡相关概念，参考如下链接：
    https://blog.csdn.net/tsummerb/article/details/79248015
  	简单理解：
  		正向代理：由客户端主动告知代理需要访问哪个服务端。服务端只知道代理，不知道客户端
  		反向代理：当客户端发送的请求被代理接收后，由代理决定访问哪个服务器。客户端只知道代理，不知道服务端
  		负载均衡：
  			负载量：客户端发送的、nginx反向代理服务器接收到的请求数量
  			均衡规则：请求数量按照一定的规则进行分发到不同的服务器处理的规则
  			负载均衡：服务器接收到的请求按照规则分发的过程
  			
  		负载均衡调度算法4种：
  			轮询、iphash、fair、urlhash

```

---

#### 02-使用Nginx为静态文件服务器及配置转发动态资源请求给uWSGI服务器

​	https://github.com/kerbalwzy/aboutPython/blob/master/work-miniFrame.md#%E4%BD%BF%E7%94%A8nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%9C%E4%B8%BA%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1

​	总结：

​		可以通过新增配置文件的方式，修改Nginx的默认配置，让Nginx成为我们的静态文件服务器。如果有给IP地址绑定域名，请在配置文件中填写好 server_name 参数的值



了解以下案例：

```
反向代理简单案例：http://www.ttlsa.com/nginx/use-nginx-proxy/	

负载均衡简单案例：https://www.cnblogs.com/andyfengzp/p/6434125.html
```

---

#### 03-使用 uWSGI 服务器运行我们的项目代码

​	https://github.com/kerbalwzy/aboutPython/blob/master/work-miniFrame.md#%E4%BD%BF%E7%94%A8-uwsgi-%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%9C%E4%B8%BA%E5%8A%A8%E6%80%81%E8%B5%84%E6%BA%90%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8

​	总结：

​	1.启动方式两种：命令行启动；

​				      通过ini文件启动；「推荐使用，可以将参数固化下来」

​	2.常用的参数和选项：

​		http:直接可以接受和处理浏览器的请求

​		socket：使用代理服务器转发请求

​		callable：指定application对象

​		processes：指定进程数量

​		threads：指定每个进程内开多少个线程

---

04-回顾WSGI、uwsgi、uWSGI

```
查看复习笔记：day07复习要点 -01部分
```

---

#### 05-总结-部署项目的流程

- 将项目代码拷贝到服务器上
- 在服务器上搭建好项目运行的基本的环境
- 尝试通过开发时的方式运行项目，检查项目环境是否搭建好了
- 检查项目运行的第三方服务状态是否良好「代理服务器，数据库，其他存储系统等等」
- 修改各种配置，将项目和第三方的服务有机的结合起来运行
- 在线测试，测试项目的服务能力
- 如果在线测试没有问题，就可以正式向市场推广